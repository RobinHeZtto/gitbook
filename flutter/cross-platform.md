# 跨平台开发技术

### 1. 移动端开发方式

#### 1.1 **原生开发**

&#x20;       原生的开发目前来说就是Android（JAVA、Kotlin）和IOS（Object-C、Swift），这也就是最传统最原始的移动端开发。

| 优点                 | 缺点       |
| ------------------ | -------- |
| 速度快、性能高、稳定性强、用户体验好 | 前期开发费用高  |
| 可以访问手机所有功能         | 后期维护繁琐   |
| 支持大量图形和动画          | 上线时间无法固定 |
| 可线下使用              | 升级灵活性差   |

#### 1.2 **混合开发**

&#x20;       混合开发就是H5与原生开发的结合，主要是用js和原生技术相互调用，可以初步实现跨平台使用的效果，现在我们日常使用当中有很多App都是通过这种方式实现的。

| 优点            | 缺点       |
| ------------- | -------- |
| 兼容多平台         | 性能相对较差   |
| 节省人力成本，缩短开发周期 | 用户体验不如原生 |
| 学习成本较低        | 技术不成熟    |

1.3 **跨平台开发**\
一次编写，多平台运行，不需要针对特定平台进行开发（不同的跨平台开发框架有一定的差异）。

| 优点                | 缺点        |
| ----------------- | --------- |
| 缩短开发周期            | 性能稳定性低于原生 |
| 降低开发成本            | 用户体验不如原生  |
| 学习成本相对较低 （各个平台不同） | 技术不成熟     |

### 2. Hybrid

&#x20;       依靠 WebView 容器展示H5页面，增加了H5可以通过 Javascript 调用的Js Api。通过这些 Js Api 可以调用 Native 的能力。

![](<../.gitbook/assets/image (152).png>)

**优点：**

1. 几乎可以完全继承现代Web开发的所有成果；
2. 完全动态化、跨平台；
3. web开发者不需要太多的学习成本。

**缺点：**

1. WebView的渲染效率和JS执行性能不佳，跟原生体验相差太远。
2. Android 手机系统版本和设备厂商的定制，很难保证所在所有设备上都能提供一致的体验。

### 3. RN系列

&#x20;       包括[React Native](https://facebook.github.io/react-native/) 和 [Weex](https://weex.incubator.apache.org/) 。为了解决 WebView 性能差的问题，以 RN 为代表的这一类框架将最终渲染工作交还给了系统，虽然同样使用类 HTML+JS 的 UI 构建逻辑，但最终会生成对应的**自定义原生控件**，以充分利用原生控件相对于 WebView 更优的绘制效率。与此同时这种策略也将框架本身和App开发者绑在了系统的控件系统上，不仅框架本身需要处理大量平台相关的逻辑，随着系统版本和API的变化，开发者可能也需要处理不同平台的差异，甚至有些特性只能在部分平台上实现（比如 RN 的`ToastAndroid` 顾名思义只能在 Android 使用），这样框架的跨平台特性就会大打折扣。

![](<../.gitbook/assets/image (114).png>)

下面对比一下这两个框架的原理和优缺点：

#### 3.1 React Native

&#x20;       [React](https://zh-hans.reactjs.org/) 是一套可以用简洁的语法高效绘制 DOM 的框架，它将网页上真实的 DOM 节点，抽象为 Virtual DOM —— 一个存在于内存中的 JavaScript 对象，与 DOM 一一对应。当界面发生变化时，得益于 DOM Diff 算法能够知道 Virtual DOM 的变化，从而高效改动 DOM，避免重新绘制 DOM。

![](<../.gitbook/assets/image (150).png>)

RN 其实就是**Native 版本的 React**, 目的是让不熟悉原生平台的前端同学利用 React 也能开发 iOS/Android App。

**缺点：**

1. Learn once, write anywhere. 一致性程度有限，不少组件和API都区分了 Android 和 iOS 版本。即使是共用组件，也会有平台独享的函数。平台间的差异性导致维护成本高。
2. 对移动端开发学习成本高，对前端开发者来说也需要对原生平台有所了解。
3. 滑动列表性能表现不佳：
   * 不支持视图重用，随着 Cell 数量的增加，占用的内存也线性增加。
   * UITableView 是主线程同步的，为了保证 UI 流畅度，UI 的渲染需要达到60帧/秒，每帧的大致消耗时间保持在16ms之内。而RN 运行在单独线程，和UI主线程不同步，也就是从 RN Render 到真正调用 native 代码这个过程是异步的，导致从js运行到最后系统渲染的总时间很难做到<16ms.

####

#### 3.2 Weex

&#x20;       Weex 使用的前端框架是[Vue](https://vuejs.org/),  相比 React 更轻量一些。

![](<../.gitbook/assets/image (269).png>)

![](<../.gitbook/assets/image (268).png>)

#### 优点 <a href="#you-dian-1" id="you-dian-1"></a>

1. 相比 RN 滑动列表性能好。充分利用了`UITableView`或者`RecycleView`的重用机制实现了性能的优化。
2. Write Once, Run Everywhere. 保持Web、Android 和 iOS 三端高度一致性。
3. 功能扩展更灵活，一些三方库如图片、网络等可由开发者自己适配。

#### &#x20;3.3 **对比**

![](<../.gitbook/assets/image (447).png>)



### 4. Flutter

&#x20;       Flutter 通过跨平台的 Skia 图形库实现渲染引擎，所有控件都是使用 Dart 语言重新开发（Material是安卓风格的控件库，Cupertino是iOS风格的控件库），然后通过自己的渲染引擎绘制出来，不使用系统原生控件。这样可以在最大程度上保证不同平台、不同设备的体验一致性。支持AOT的Dart语言，执行效率也非常高，使得Flutter完全可以媲美原生应用的性能。

&#x20;       Flutter框架的整个架构如下：

![](<../.gitbook/assets/image (477).png>)
